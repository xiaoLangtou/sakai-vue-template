# 收藏/常用功能使用说明

## ✨ 功能概述

收藏功能允许用户将高频使用的菜单项固定在菜单顶部，实现快速访问。遵循 **80/20 法则**：80% 的时间可能只用 20% 的功能。

## 🎯 核心特性

### 1. **精准定位高频功能**

| 对比项 | 最近访问 | 收藏功能 |
|--------|----------|----------|
| 触发方式 | 自动记录 | 用户主动选择 ✅ |
| 准确性 | 可能包含低频功能 | 只包含高频功能 ✅ |
| 持久性 | 可能被新访问覆盖 | 永久保存 ✅ |
| 控制权 | 系统控制 | 用户控制 ✅ |

### 2. **快速访问**
- ✅ 固定在菜单最顶部
- ✅ 一键直达，无需层层展开
- ✅ 支持最多 10 个收藏
- ✅ 自动持久化到 localStorage

### 3. **灵活管理**
- ✅ 点击星标即可收藏/取消收藏
- ✅ 收藏数量实时显示
- ✅ 支持拖拽排序（待实现）

## 📖 使用方法

### 添加收藏

**方式 1：通过菜单项星标按钮**
```
1. 找到要收藏的菜单项（仅顶级菜单可收藏）
2. 鼠标悬停在菜单项上
3. 点击右侧出现的星标图标 ⭐
4. 星标变为黄色，表示已收藏
```

**限制条件**：
- ✅ 只有顶级菜单可以收藏
- ✅ 必须有路由路径（path）
- ✅ 不能是外部链接
- ✅ 最多收藏 10 个

### 取消收藏

**方式 1：通过菜单项星标**
```
1. 找到已收藏的菜单项（星标为黄色）
2. 点击星标图标
3. 星标变为空心，表示已取消收藏
```

**方式 2：通过收藏列表**
```
1. 在菜单顶部找到"常用功能"分组
2. 鼠标悬停在要取消的收藏项上
3. 点击右侧的黄色星标
4. 该项从收藏列表中移除
```

### 访问收藏

```
1. 打开侧边栏菜单
2. 在最顶部看到"常用功能"分组
3. 点击任意收藏项即可快速跳转
```

## 🎨 界面说明

### 展开状态

```
┌─────────────────────────────┐
│ ⭐ 常用功能              3  │  ← 收藏分组标题
├─────────────────────────────┤
│ 📊 数据看板              ⭐ │  ← 收藏项 1
│ 👥 用户管理              ⭐ │  ← 收藏项 2
│ 📝 订单列表              ⭐ │  ← 收藏项 3
├─────────────────────────────┤  ← 分隔线
│ 📁 系统管理              ▶ │  ← 常规菜单
│ 📁 内容管理              ▶ │
└─────────────────────────────┘
```

### 折叠状态

```
┌────┐
│ ⭐ │  ← 收藏图标
├────┤
│ 📁 │  ← 常规菜单
│ 📁 │
└────┘
```

### 菜单项状态

```
┌─────────────────────────────┐
│ 📊 用户管理           ☆ │  ← 未收藏（悬停显示）
│ 📊 数据看板           ⭐ │  ← 已收藏（黄色）
│ 📊 订单列表  [激活]   ⭐ │  ← 激活状态
└─────────────────────────────┘
```

## 🔧 技术实现

### 数据结构

```typescript
interface FavoriteMenuItem {
    id: number;           // 菜单 ID
    title: string;        // 菜单标题
    path: string;         // 路由路径
    icon?: string;        // 图标
    params?: Record;      // 路由参数
    query?: Record;       // 查询参数
    timestamp: number;    // 收藏时间
}
```

### Store 方法

```typescript
// 检查是否已收藏
favoritesStore.isFavorite(menuId)

// 添加收藏
favoritesStore.addFavorite(menu)

// 移除收藏
favoritesStore.removeFavorite(menuId)

// 切换收藏状态
favoritesStore.toggleFavorite(menu)

// 清空所有收藏
favoritesStore.clearFavorites()
```

### 组件结构

```
src/layout/shared/
├── app-favorites-menu.vue    # 收藏菜单组件（新增）
├── app-menu.vue               # 菜单容器（已集成）
└── app-menu-item.vue          # 菜单项（已添加星标）

src/stores/
└── favorites.ts               # 收藏 Store（新增）
```

## 💡 使用场景

### 场景 1：后台管理员

```
常用功能：
- 用户管理（每天查看）
- 订单列表（高频操作）
- 数据统计（每日必看）

收藏这些功能后，每次打开系统直接点击，无需展开多级菜单。
```

### 场景 2：内容编辑

```
常用功能：
- 文章管理
- 分类管理
- 评论审核

收藏后快速切换，提升工作效率。
```

### 场景 3：客服人员

```
常用功能：
- 工单列表
- 用户反馈
- 知识库

一键访问，快速响应用户需求。
```

## 📊 数据持久化

### 存储位置
```javascript
localStorage.setItem('app-favorites', JSON.stringify(favorites))
```

### 存储格式
```json
{
  "favoriteMenus": [
    {
      "id": 1,
      "title": "用户管理",
      "path": "/system/user",
      "icon": "Users",
      "timestamp": 1701234567890
    }
  ]
}
```

### 自动同步
- ✅ 添加/删除收藏时自动保存
- ✅ 刷新页面自动恢复
- ✅ 跨标签页同步（同域名）

## 🎓 最佳实践

### 1. **选择真正高频的功能**

❌ 不推荐：
- 系统设置（低频）
- 关于我们（极低频）
- 帮助文档（偶尔使用）

✅ 推荐：
- 数据看板（每天查看）
- 订单管理（高频操作）
- 用户列表（常用功能）

### 2. **控制收藏数量**

```
建议：3-5 个
最多：10 个
原因：太多反而不方便查找
```

### 3. **定期清理**

```
每月检查一次收藏列表
移除不再常用的功能
添加新的高频功能
```

### 4. **按使用频率排序**

```
最常用的放在最上面
次常用的依次排列
（拖拽排序功能待实现）
```

## 🚀 性能优化

- ✅ 使用 `computed` 缓存收藏列表
- ✅ 使用 `Set` 快速查找收藏状态
- ✅ 防抖处理收藏操作
- ✅ 懒加载收藏菜单组件

## 🔒 安全性

- ✅ 只能收藏有权限的菜单
- ✅ 路由跳转前验证权限
- ✅ localStorage 数据验证
- ✅ XSS 防护

## 🐛 故障排除

### 问题 1：收藏按钮不显示

**原因**：
- 不是顶级菜单
- 没有路由路径
- 是外部链接

**解决**：只有顶级菜单且有路径才能收藏

### 问题 2：收藏数量达到上限

**提示**：`收藏数量已达上限 (10)`

**解决**：先取消一些不常用的收藏

### 问题 3：刷新后收藏丢失

**原因**：localStorage 被清理

**解决**：检查浏览器设置，确保允许 localStorage

## 📈 未来扩展

### 计划功能

- [ ] 拖拽排序
- [ ] 收藏分组
- [ ] 导入/导出收藏
- [ ] 收藏统计（使用频率）
- [ ] 智能推荐（基于使用习惯）
- [ ] 团队共享收藏
- [ ] 收藏备注

### API 扩展

```typescript
// 批量操作
favoritesStore.batchAddFavorites(menus)
favoritesStore.batchRemoveFavorites(menuIds)

// 排序
favoritesStore.reorderFavorite(fromIndex, toIndex)

// 统计
favoritesStore.getMostUsed()
favoritesStore.getUsageStats()
```

## 🎉 总结

收藏功能是提升用户体验的关键功能：

- ✅ **提升效率**：快速访问高频功能
- ✅ **用户控制**：主动选择，更精准
- ✅ **持久化**：永久保存，不丢失
- ✅ **易用性**：一键收藏，简单直观

**记住**：收藏你最常用的功能，让工作更高效！⭐
